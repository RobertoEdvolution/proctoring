define(["jquery","core/ajax","core/notification"],function(e,t,a){const n=async(e,t)=>{const a=await faceapi.detectAllFaces(e);if(0===a.length)console.log("Face not found");else{let n=a[0].box;await(async(e,t,a)=>{const n=[new faceapi.Rect(t.x,t.y,t.width,t.height)];let i=await faceapi.extractFaces(e,n);0===i.length?console.log("Face not found"):i.forEach(e=>{a.src=e.toDataURL()})})(e,n,t)}};return{setup:async function(i,o){return null!=o&&await faceapi.nets.ssdMobilenetv1.loadFromUri(o),e("#fcvalidate").append('<img id="validate-cropimg" style="display: none;" src="" alt=""/>'),e("#fcvalidate").click(async function(c){c.preventDefault();const l=document.getElementById("photo"),s=document.getElementById("canvas"),d=document.getElementById("video"),r=s.getContext("2d");s.width=i.imagewidth,s.height=s.width/(4/3),r.drawImage(d,0,0,s.width,s.height);var g=s.toDataURL("image/png");l.setAttribute("src",g);const m=document.getElementById("courseidval").value,u=document.getElementById("cmidval").value,p=document.getElementById("profileimage").value;let y,f,v=e("#validate-cropimg");null!=o&&await n(l,v),v.src?(y=1,f=v.src):(y=0,f="");const h={methodname:"quizaccess_proctoring_validate_face",args:{courseid:m,cmid:u,profileimage:p,webcampicture:g,parenttype:"camshot_image",faceimage:f,facefound:y}};document.getElementById("loading_spinner").style.display="block",t.call([h])[0].done(function(t){t.warnings.length<1?(document.getElementById("loading_spinner").style.display="none","success"===t.status?(e("#video").css("border","10px solid green"),e("#face_validation_result").html('<span style="color: green">True</span>'),document.getElementById("fcvalidate").style.display="none",e("#form_activate").css("visibility","visible")):(e("#video").css("border","10px solid red"),e("#face_validation_result").html('<span style="color: red">False</span>'))):(document.getElementById("loading_spinner").style.display="none",d&&a.addNotification({message:"Something went wrong during taking the image.",type:"error"}))}).fail(a.exception)}),!0}}});
//# sourceMappingURL=startAttempt.min.js.map